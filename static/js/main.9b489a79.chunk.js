(this.webpackJsonprandom_fill=this.webpackJsonprandom_fill||[]).push([[0],{105:function(e,t,n){},106:function(e,t,n){},107:function(e,t,n){},167:function(e,t,n){},168:function(e,t,n){},169:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(6),u=n.n(a),i=n(2),o=(n(105),n(106),n(29)),l=n(9);n(107);function f(e,t,n){for(var r=[],c=0;c<e;c++){for(var a=[],u=0;u<t;u++)a.push(n||null);r.push(a)}return r}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return Math.floor(Math.random()*e)+1}function m(e){return function(t){t({type:"SET_TEMP_FIELD_MATRIX",tempFieldMatrix:e})}}function s(e){return function(t){t({type:"SET_PLAYER",dice:null,currentFigure:null,currentPlayer:e})}}var v=n(172),E=n(171),y=n(63);var p=function(){var e=Object(i.b)(),t=Object(r.useState)(20),n=Object(l.a)(t,2),a=n[0],u=n[1],m=Object(r.useState)(20),s=Object(l.a)(m,2),p=s[0],g=s[1],b=Object(r.useState)(["player1","player2"]),h=Object(l.a)(b,2),O=h[0],j=h[1];return c.a.createElement("div",{className:"configurator"},c.a.createElement(v.a,{min:20,max:45,value:a,onChange:function(e){return u(Number(e))},type:"number"}),c.a.createElement(v.a,{min:20,max:45,value:p,onChange:function(e){return g(Number(e))},type:"number"}),c.a.createElement("div",{className:"players"}),O.map((function(e,t){return c.a.createElement("div",{className:"players__item",key:t},c.a.createElement(E.a,{type:"text",value:e,onChange:function(e){return function(e,t){var n=O.map((function(n,r){return r===t?e:n}));j(n)}(e.target.value,t)}}),c.a.createElement(y.a,{type:"primary",danger:!0,disabled:O.length<=2,onClick:function(e){return j(O.filter((function(e,n){return n!==t})))}},"X"))})),c.a.createElement(y.a,{type:"primary",block:!0,disabled:O.length>=4,onClick:function(e){return j([].concat(Object(o.a)(O),["player".concat(O.length+1)]))}},"add player"),c.a.createElement(y.a,{type:"primary",block:!0,onClick:function(){var t;a<20||p<20||a>45||p>45||e((t={players:O,x:a,y:p},function(e){var n=t.players.map((function(e,t){return{name:e,color:["Red","Green","Yellow","Blue"][t],count:0}})),r=n[d(n.length)-1];e({type:"SET_CONFIG",config:t,fieldMatrix:f(t.x,t.y),tempFieldMatrix:f(t.x,t.y),players:n,currentPlayer:r})}))}},"submit config"))},g=n(91);n(167);var b=function(){var e=Object(r.useRef)(null),t=Object(i.b)(),n=Object(i.c)((function(e){return e.game.fieldMatrix})),a=Object(i.c)((function(e){return e.game.tempFieldMatrix})),u=Object(i.c)((function(e){return e.game.cellSide})),o=Object(i.c)((function(e){return e.game.config})),f=Object(i.c)((function(e){return e.game.currentPlayer})),d=Object(i.c)((function(e){return e.game.dice})),s=Object(i.c)((function(e){return e.game.currentFigureX})),v=Object(i.c)((function(e){return e.game.currentFigureY})),E=Object(r.useState)(null),y=Object(l.a)(E,2),p=y[0],g=y[1];return Object(r.useEffect)((function(){e.current&&g(e.current.getBoundingClientRect())}),[e]),Object(r.useEffect)((function(){if(e.current&&p&&o&&a&&n&&d&&f)if(O(p,s,v)){var r=(s-p.left)/u,c=(v-p.top)/u,i=S(r,c,d);if(x(i,o))return;var l=h(null===f||void 0===f?void 0:f.count);if(l&&!j(i,o))return;if(!_(n,i,f,l))return;var E=F(n,i,f);l||C(E,f.color),t(m(E))}else t(m(n))}),[s,v]),c.a.createElement("div",{ref:e,className:"game-field"},a&&a.map((function(e,t){return c.a.createElement("div",{key:t,className:"game-field__row"},e.map((function(e,t){return c.a.createElement("span",{key:t,style:{backgroundColor:e||""},className:"game-field__cell"})})))})))},h=function(e){return 0===e},O=function(e,t,n){var r=e.left<t&&e.right>t,c=e.top<n&&e.bottom>n;return!(!r||!c)},j=function(e,t){var n=t.x,r=t.y;return e.xStart<=0&&e.yStart<=0||e.xEnd===n&&e.yStart<=0||0===e.xStart&&e.yEnd===r||e.xEnd===n&&e.yEnd===r},x=function(e,t){var n=t.x,r=t.y;return e.xStart<0||e.xEnd>n||e.yStart<0||e.yEnd>r},S=function(e,t,n){return{xStart:Math.round(e-n[1]/2),xEnd:Math.round(e+n[1]/2),yStart:Math.round(t-n[0]/2),yEnd:Math.round(t+n[0]/2)}},_=function(e,t,n,r){if(r)return!0;var c=e.reduce((function(e,n,r,c){return t.yStart-1!==r&&r!==t.yEnd||e.push.apply(e,Object(o.a)(n.filter((function(e,n){return t.xStart<=n&&n<t.xEnd})))),t.yStart<=r&&r<t.yEnd&&e.push.apply(e,Object(o.a)(n.filter((function(e,n){return t.xStart-1===n||n===t.xEnd})))),e}),[]);return!(e.reduce((function(e,n,r,c){return t.yStart<=r&&r<t.yEnd&&e.push.apply(e,Object(o.a)(n.filter((function(e,n){return t.xStart<=n&&n<t.xEnd})))),e}),[]).filter((function(e){return e})).length>0)&&c.filter((function(e){return e===n.color})).length>0},F=function(e,t,n){return e.map((function(e,r){return t.yStart<=r&&r<t.yEnd?e.map((function(e,r){return t.xStart<=r&&r<t.xEnd?n.color:e})):e.slice()}))},C=function(e,t){var n=e.map((function(e,n){return e.map((function(e,n){return e===t||null===e&&null}))}));n.filter((function(e){return e.filter((function(e){return!1===e})).length})).length&&I(n).forEach((function(n,r){return n.forEach((function(n,c){!0===n&&(e[r][c]=t)}))}))},I=function(e){return e.forEach((function(t,n){return t.forEach((function(t,r){!1!==e[n][r]&&(T(e,{y:n,x:r}),e.forEach((function(t,n){return t.forEach((function(t,r){"?"===t&&(e[n][r]=!0)}))})))}))})),e},T=function e(t,n){var r=n.x,c=n.y;if(!0===t[c][r]||M(r,c,t))return!0;var a=[new k(r,c-1),new k(r+1,c),new k(r,c+1),new k(r-1,c)];return a.filter((function(e){return!1===e.currentContent(t)})).length>0?(a.forEach((function(e){void 0!==e.currentContent(t)&&!0!==e.currentContent(t)&&(t[e.y][e.x]=!1)})),void 0!==t[c][r]&&!0!==t[c][r]&&(t[c][r]=!1),t.forEach((function(e,n){return e.forEach((function(e,r){"?"===e&&(t[n][r]=!1)}))})),!1):(t[c][r]="?",a.filter((function(n){return void 0===n.currentContent(t)||!0===n.currentContent(t)||"?"===n.currentContent(t)||(null===n.currentContent(t)?e(t,{x:n.x,y:n.y}):void 0)})).length>=4)},M=function(e,t,n){return t<0||e<0||t>=n.length||e>=n[0].length},k=function e(t,n){var r=this;Object(g.a)(this,e),this.x=void 0,this.y=void 0,this.currentContent=function(e){var t;return null===(t=e[r.y])||void 0===t?void 0:t[r.x]},this.x=t,this.y=n};n(168);var w=function(){var e=Object(r.useRef)(null),t=Object(i.c)((function(e){return e.game.dice})),n=Object(i.c)((function(e){return e.game.currentFigure})),a=Object(i.c)((function(e){return e.game.currentPlayer})),u=Object(i.c)((function(e){return e.game.players})),o=Object(i.c)((function(e){return e.game.tempFieldMatrix})),v=Object(i.c)((function(e){return e.game.fieldMatrix})),E=Object(r.useState)(!1),p=Object(l.a)(E,2),g=p[0],b=p[1],h=Object(r.useState)(!1),O=Object(l.a)(h,2),j=O[0],x=O[1],S=Object(i.b)(),_=Object(r.useCallback)((function(t){var n,r;e.current&&(e.current.style.left=t.pageX-e.current.offsetWidth/2+"px",e.current.style.top=t.pageY-e.current.offsetHeight/2+"px",S((n=t.x,r=t.y,function(e){e({type:"SET_FIGURE_POSITION",currentFigureX:n,currentFigureY:r})})))}),[]);return c.a.createElement("div",{className:"curent-step"},c.a.createElement("div",null,null===a||void 0===a?void 0:a.name),c.a.createElement("div",null,null===a||void 0===a?void 0:a.count),c.a.createElement(y.a,{disabled:j,type:"primary",onClick:function(){var e;x(!0),S((e=null===a||void 0===a?void 0:a.color,function(t){var n=d(),r=d();t({type:"ROLL_THE_DICE",dice:[n,r],currentFigure:f(n,r,e)})}))}},"roll the dice"),c.a.createElement(y.a,{type:"primary",disabled:!t,onClick:function(){S(function(e,t){return function(n){var r=e[1],c=e[0];n({type:"ROTATE_FIGURE",dice:[r,c],currentFigure:f(r,c,t)})}}(t||[1,1],null===a||void 0===a?void 0:a.color))}},"rotate"),c.a.createElement(y.a,{onClick:function(){if(u&&a&&v){var e=u.findIndex((function(e){return e.name===a.name})),t=u[e+1]||u[0];b(!1),x(!1),S(s(t)),S(m(v))}}},"pass"),c.a.createElement("div",null,t&&t[1]),c.a.createElement("div",null,t&&t[0]),c.a.createElement("div",{ref:e,className:"new-figure",onMouseDown:function(t){e.current&&!g&&(e.current.style.position="absolute",e.current.style.top=t.pageY-e.current.offsetHeight/2+"px",e.current.style.left=t.pageX-e.current.offsetWidth/2+"px",document.addEventListener("mousemove",_))},onMouseUp:function(t){if(document.removeEventListener("mousemove",_),e.current){e.current.style.position="static",e.current.style.top="auto",e.current.style.left="auto";var n=(null===o||void 0===o?void 0:o.join())!==(null===v||void 0===v?void 0:v.join());o&&n&&b(!0)}}},n&&n.map((function(e,t){return c.a.createElement("div",{key:t,className:"new-figure__row"},e.map((function(e,t){return c.a.createElement("span",{key:t,style:{backgroundColor:g?"grey":e||""},className:"new-figure__cell"})})))}))),g&&c.a.createElement(c.a.Fragment,null,c.a.createElement(y.a,{onClick:function(){v&&(b(!1),S(m(v)))}},"undo"),c.a.createElement(y.a,{onClick:function(){if(u&&a&&o){var e,t=(null===o||void 0===o?void 0:o.join())!==(null===v||void 0===v?void 0:v.join());o&&t&&S((e=o,function(t){t({type:"SET_FIELD_MATRIX",fieldMatrix:e})}));var n=u.findIndex((function(e){return e.name===a.name})),r=u[n+1]||u[0];b(!1),x(!1),a.count=o.flat().filter((function(e){return e===a.color})).length,S(s(Object.assign({},a))),S(s(r))}}},"submit")))};var N=function(){var e=Object(i.c)((function(e){return e.game.config}));return c.a.createElement("div",{className:"app"},!e&&c.a.createElement(p,null),!!e&&c.a.createElement(c.a.Fragment,null,c.a.createElement(b,null),c.a.createElement(w,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var R=n(26),L=n(92),P=n(93),X=n.n(P),A=n(3),G={config:null,cellSide:20,fieldMatrix:null,tempFieldMatrix:null,dice:null,currentFigure:null,players:null,currentPlayer:null,currentFigureX:0,currentFigureY:0};var Y=Object(R.d)(Object(R.c)({game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ROLL_THE_DICE":case"ROTATE_FIGURE":case"SET_CONFIG":case"SET_FIGURE_POSITION":case"SET_FIELD_MATRIX":case"SET_TEMP_FIELD_MATRIX":case"SET_FINAL_FIGURE_POSITION":case"SET_PLAYER":return Object(A.a)(Object(A.a)({},e),t);default:return e}}}),Object(R.a)(L.a,X.a));u.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(i.a,{store:Y},c.a.createElement(N,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},95:function(e,t,n){e.exports=n(169)}},[[95,1,2]]]);
//# sourceMappingURL=main.9b489a79.chunk.js.map