(this.webpackJsonprandom_fill=this.webpackJsonprandom_fill||[]).push([[0],{114:function(e,t,n){e.exports=n(264)},124:function(e,t,n){},125:function(e,t,n){},257:function(e,t,n){},258:function(e,t,n){},259:function(e,t,n){},260:function(e,t,n){},261:function(e,t,n){},262:function(e,t,n){},264:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(4),o=n.n(c),i=n(3);n(124);function u(e,t,n){for(var r=[],a=0;a<e;a++){for(var c=[],o=0;o<t;o++)c.push(n?{color:n,opacity:1}:null);r.push(c)}return r}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return Math.floor(Math.random()*e)+1}function f(e){return function(t){t({type:"SET_TEMP_FIELD_MATRIX",tempFieldMatrix:e})}}function s(e){return function(t){t({type:"SET_PLAYER",dice:null,currentFigure:null,currentPlayer:e})}}var d=n(268),m=n(267),v=n(266),E=n(270),y=n(269),p=n(70),g=n(272),h=n(271);n(125);var b=function(){var e=Object(i.b)();return a.a.createElement(d.a,{initialValues:{x:20,y:20,players:["Player 1","Player 2"]},onFinish:function(t){var n,r=t.x,a=t.y,c=t.players;return e((n={x:r,y:a,players:c},function(e){var t=n.players.map((function(e,t){return{name:e,color:["Red","Green","Yellow","Blue"][t],count:0}})),r=t[l(t.length)-1];e({type:"SET_CONFIG",config:n,fieldMatrix:u(n.x,n.y),tempFieldMatrix:u(n.x,n.y),players:t,currentPlayer:r})}))},className:"configurator"},a.a.createElement(m.a,{title:"Configurator"},a.a.createElement(v.a,{direction:"vertical"},a.a.createElement(d.a.Item,Object.assign({},O,{label:"Cells horizontaly",name:"y",rules:[{required:!0,message:"Please, input Y cells"}]}),a.a.createElement(E.a,{min:20,max:45})),a.a.createElement(d.a.Item,Object.assign({},O,{label:"Cells verticaly",name:"x",rules:[{required:!0,message:"Please, input X cells"}]}),a.a.createElement(E.a,{min:20,max:45})),a.a.createElement(d.a.List,{name:"players"},(function(e,t){var n=t.add,r=t.remove;return a.a.createElement("div",{style:{minHeight:224,minWidth:270}},e.map((function(t,n){return a.a.createElement(d.a.Item,{label:"Player ".concat(n+1),required:!0,key:t.key},a.a.createElement(d.a.Item,Object.assign({},t,{rules:[{required:!0,message:"Please input player's name."}],noStyle:!0}),a.a.createElement(y.a,{placeholder:"player name",style:{width:"90%"}})),e.length>2?a.a.createElement(g.a,{style:{marginLeft:5},onClick:function(){return r(t.name)}}):null)})),e.length<4?a.a.createElement(d.a.Item,null,a.a.createElement(p.a,{type:"dashed",onClick:function(){return n()}},a.a.createElement(h.a,null)," Add player")):null)})),a.a.createElement(d.a.Item,null,a.a.createElement(p.a,{type:"primary",block:!0,htmlType:"submit"},"Submit")))))},O={labelCol:{span:12},wrapperCol:{span:12}};n(257);var x=function(){return a.a.createElement("div",{className:"header"},"GAME RANDOMFILL")},j=n(38);n(258);var S=function(){var e=Object(r.useRef)(null),t=Object(i.c)((function(e){return e.game.dice})),n=Object(i.c)((function(e){return e.game.currentFigure})),c=Object(i.c)((function(e){return e.game.currentPlayer})),o=Object(i.c)((function(e){return e.game.players})),d=Object(i.c)((function(e){return e.game.tempFieldMatrix})),m=Object(i.c)((function(e){return e.game.fieldMatrix})),v=Object(r.useState)(!1),E=Object(j.a)(v,2),y=E[0],g=E[1],h=Object(r.useState)(!1),b=Object(j.a)(h,2),O=b[0],x=b[1],S=Object(i.b)(),_=Object(r.useCallback)((function(t){var n,r;e.current&&(e.current.style.left=t.pageX-e.current.offsetWidth/2+"px",e.current.style.top=t.pageY-e.current.offsetHeight/2+"px",S((n=t.x,r=t.y,function(e){e({type:"SET_FIGURE_POSITION",currentFigureX:n,currentFigureY:r})})))}),[S]);return a.a.createElement("div",{className:"curent-step"},a.a.createElement("div",null,null===c||void 0===c?void 0:c.name),a.a.createElement("div",null,null===c||void 0===c?void 0:c.count),a.a.createElement(p.a,{disabled:O,type:"primary",onClick:function(){var e;(null===c||void 0===c?void 0:c.color)&&(x(!0),S((e=null===c||void 0===c?void 0:c.color,function(t){var n=l(),r=l();t({type:"ROLL_THE_DICE",dice:[n,r],currentFigure:u(n,r,e)})})))}},"roll the dice"),a.a.createElement(p.a,{type:"primary",disabled:!t,onClick:function(){(null===c||void 0===c?void 0:c.color)&&S(function(e,t){return function(n){var r=e[1],a=e[0];n({type:"ROTATE_FIGURE",dice:[r,a],currentFigure:u(r,a,t)})}}(t||[1,1],null===c||void 0===c?void 0:c.color))}},"rotate"),a.a.createElement(p.a,{onClick:function(){if(o&&c&&m){var e=o.findIndex((function(e){return e.name===c.name})),t=o[e+1]||o[0];g(!1),x(!1),S(s(t)),S(f(m))}}},"pass"),a.a.createElement("div",null,t&&t[1]),a.a.createElement("div",null,t&&t[0]),a.a.createElement("div",{ref:e,className:"new-figure",onMouseDown:function(t){e.current&&!y&&(e.current.style.position="absolute",e.current.style.top=t.pageY-e.current.offsetHeight/2+"px",e.current.style.left=t.pageX-e.current.offsetWidth/2+"px",document.addEventListener("mousemove",_))},onMouseUp:function(t){if(document.removeEventListener("mousemove",_),e.current){e.current.style.position="static",e.current.style.top="auto",e.current.style.left="auto";var n=(null===d||void 0===d?void 0:d.join())!==(null===m||void 0===m?void 0:m.join());d&&n&&g(!0)}}},n&&n.map((function(e,t){return a.a.createElement("div",{key:t,className:"new-figure__row"},e.map((function(e,t){return a.a.createElement("span",{key:t,style:{backgroundColor:y?"grey":(null===e||void 0===e?void 0:e.color)||"",zIndex:100},className:"new-figure__cell"})})))}))),y&&a.a.createElement(a.a.Fragment,null,a.a.createElement(p.a,{onClick:function(){m&&(g(!1),S(f(m)))}},"undo"),a.a.createElement(p.a,{onClick:function(){if(o&&c&&d){var e,t=(null===d||void 0===d?void 0:d.join())!==(null===m||void 0===m?void 0:m.join());d&&t&&S((e=d.map((function(e){return e.map((function(e){return e&&(e.opacity=1),e}))})),function(t){t({type:"SET_FIELD_MATRIX",fieldMatrix:e})}));var n=o.findIndex((function(e){return e.name===c.name})),r=o[n+1]||o[0];g(!1),x(!1),c.count=d.flat().filter((function(e){return(null===e||void 0===e?void 0:e.color)===c.color})).length,S(s(Object.assign({},c))),S(s(r))}}},"submit")))},_=n(68),I=n(53);n(259);var F=function(){var e=Object(r.useRef)(null),t=Object(i.b)(),n=Object(i.c)((function(e){return e.game.fieldMatrix})),c=Object(i.c)((function(e){return e.game.tempFieldMatrix})),o=Object(i.c)((function(e){return e.game.cellSide})),u=Object(i.c)((function(e){return e.game.config})),l=Object(i.c)((function(e){return e.game.currentPlayer})),s=Object(i.c)((function(e){return e.game.dice})),d=Object(i.c)((function(e){return e.game.currentFigureX})),m=Object(i.c)((function(e){return e.game.currentFigureY})),v=Object(r.useState)(null),E=Object(j.a)(v,2),y=E[0],p=E[1];return Object(r.useEffect)((function(){e.current&&p(e.current.getBoundingClientRect())}),[e]),Object(r.useEffect)((function(){if(e.current&&y&&u&&c&&n&&s&&l)if(M(y,d,m)){var r=(d-y.left)/o,a=(m-y.top)/o,i=k(r,a,s),v=C(null===l||void 0===l?void 0:l.count);if(w(i,u))t(f(n));else if(v&&!T(i,u))t(f(n));else if(R(n,i,l,v)){var E=N(n,i,l.color,v);t(f(E))}else t(f(n))}else t(f(n))}),[d,m,o,u,t]),a.a.createElement("div",{ref:e,className:"game-field"},c&&c.map((function(e,t){return a.a.createElement("div",{key:t,className:"game-field__row"},e.map((function(e,t){return a.a.createElement("span",{key:t,style:{backgroundColor:(null===e||void 0===e?void 0:e.color)||"",opacity:null===e||void 0===e?void 0:e.opacity},className:"game-field__cell"})})))})))},C=function(e){return 0===e},M=function(e,t,n){var r=e.left<t&&e.right>t,a=e.top<n&&e.bottom>n;return!(!r||!a)},T=function(e,t){var n=t.x,r=t.y;return e.xStart<=0&&e.yStart<=0||e.xEnd===n&&e.yStart<=0||0===e.xStart&&e.yEnd===r||e.xEnd===n&&e.yEnd===r},w=function(e,t){var n=t.x,r=t.y;return e.xStart<0||e.xEnd>n||e.yStart<0||e.yEnd>r},k=function(e,t,n){return{xStart:Math.round(e-n[1]/2),xEnd:Math.round(e+n[1]/2),yStart:Math.round(t-n[0]/2),yEnd:Math.round(t+n[0]/2)}},R=function(e,t,n,r){if(r)return!0;var a=e.reduce((function(e,n,r,a){return t.yStart-1!==r&&r!==t.yEnd||e.push.apply(e,Object(I.a)(n.filter((function(e,n){return t.xStart<=n&&n<t.xEnd})))),t.yStart<=r&&r<t.yEnd&&e.push.apply(e,Object(I.a)(n.filter((function(e,n){return t.xStart-1===n||n===t.xEnd})))),e}),[]);return!(e.reduce((function(e,n,r,a){return t.yStart<=r&&r<t.yEnd&&e.push.apply(e,Object(I.a)(n.filter((function(e,n){return t.xStart<=n&&n<t.xEnd})))),e}),[]).filter((function(e){return e})).length>0)&&a.filter((function(e){return(null===e||void 0===e?void 0:e.color)===n.color})).length>0},N=function(e,t,n,r){var a=e.map((function(e,r){return t.yStart<=r&&r<t.yEnd?e.map((function(e,r){return t.xStart<=r&&r<t.xEnd?{color:n,opacity:.5}:e?Object.assign({},e):null})):e.slice()}));return r||P(a,n),a},P=function(e,t){var n=e.map((function(e,n){return e.map((function(e,n){return(null===e||void 0===e?void 0:e.color)===t?new G(!0,e.opacity):null===e?new G(null,1):new G(!1,e.opacity)}))}));n.filter((function(e){return e.filter((function(e){return!1===e.content})).length})).length&&L(n).forEach((function(n,r){return n.forEach((function(n,a){!0===n.content&&(e[r][a]={color:t,opacity:n.opacity})}))}))},L=function(e){return e.forEach((function(t,n){return t.forEach((function(t,r){!1!==e[n][r].content&&(A(e,{y:n,x:r}),e.forEach((function(t,n){return t.forEach((function(t,r){"?"===t.content&&(e[n][r].content=!0,e[n][r].opacity=.5)}))})))}))})),e},A=function e(t,n){var r=n.x,a=n.y;if(!0===t[a][r].content||X(r,a,t))return!0;var c=[new Y(r,a-1),new Y(r+1,a),new Y(r,a+1),new Y(r-1,a)];return c.filter((function(e){var n;return!1===(null===(n=e.currentContent(t))||void 0===n?void 0:n.content)})).length>0?(c.forEach((function(e){void 0!==e.currentContent(t)&&!0!==e.currentContent(t).content&&(t[e.y][e.x].content=!1)})),void 0!==t[a][r]&&!0!==t[a][r].content&&(t[a][r].content=!1),t.forEach((function(e,n){return e.forEach((function(e,r){"?"===e.content&&(t[n][r].content=!1)}))})),!1):(t[a][r].content="?",c.filter((function(n){return void 0===n.currentContent(t)||!0===n.currentContent(t).content||"?"===n.currentContent(t).content||null===n.currentContent(t).content&&e(t,{x:n.x,y:n.y})})).length>=4)},X=function(e,t,n){return t<0||e<0||t>=n.length||e>=n[0].length},G=function e(t,n){Object(_.a)(this,e),this.content=void 0,this.opacity=void 0,this.content=t,this.opacity=n},Y=function e(t,n){var r=this;Object(_.a)(this,e),this.x=void 0,this.y=void 0,this.currentContent=function(e){var t;return null===(t=e[r.y])||void 0===t?void 0:t[r.x]},this.x=t,this.y=n};n(260);var D=function(){return a.a.createElement("div",{className:"game"},a.a.createElement(S,null),a.a.createElement(F,null))};n(261);var U=function(){return a.a.createElement("div",{className:"footer"},"developer ",a.a.createElement("a",{href:"https://github.com/shersh1k"},"shersh1k"))};n(262);var H=function(){var e=Object(i.c)((function(e){return e.game.config}));return a.a.createElement("div",{className:"app"},a.a.createElement(x,null),e?a.a.createElement(D,null):a.a.createElement(b,null),a.a.createElement(U,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var W=n(31),q=n(109),B=(n(263),n(10)),z={config:null,cellSide:20,fieldMatrix:null,tempFieldMatrix:null,dice:null,currentFigure:null,players:null,currentPlayer:null,currentFigureX:0,currentFigureY:0};var J=[q.a];var V=Object(W.d)(Object(W.c)({game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ROLL_THE_DICE":case"ROTATE_FIGURE":case"SET_CONFIG":case"SET_FIGURE_POSITION":case"SET_FIELD_MATRIX":case"SET_TEMP_FIELD_MATRIX":case"SET_FINAL_FIGURE_POSITION":case"SET_PLAYER":return Object(B.a)(Object(B.a)({},e),t);default:return e}}}),W.a.apply(void 0,J));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(i.a,{store:V},a.a.createElement(H,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[114,1,2]]]);
//# sourceMappingURL=main.6c023dae.chunk.js.map