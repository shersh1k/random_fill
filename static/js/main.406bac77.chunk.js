(this.webpackJsonprandom_fill=this.webpackJsonprandom_fill||[]).push([[0],{118:function(e,t,n){e.exports=n(268)},128:function(e,t,n){},129:function(e,t,n){},261:function(e,t,n){},262:function(e,t,n){},263:function(e,t,n){},264:function(e,t,n){},265:function(e,t,n){},266:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(5),i=n.n(c),o=n(3),l=(n(128),n(71)),u=function e(t,n){Object(l.a)(this,e),this.content=void 0,this.opacity=void 0,this.content=t,this.opacity=n},f=function e(t,n){var r=this;Object(l.a)(this,e),this.x=void 0,this.y=void 0,this.currentContent=function(e){var t;return null===(t=e[r.y])||void 0===t?void 0:t[r.x]},this.x=t,this.y=n},s=n(58);function d(e,t,n){for(var r=[],a=0;a<e;a++){for(var c=[],i=0;i<t;i++)c.push(n?{color:n,opacity:1}:null);r.push(c)}return r}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return Math.floor(Math.random()*e)+1}function v(e,t){var n,r=e.map((function(e,n){return e.map((function(e,n){return(null===e||void 0===e?void 0:e.color)===t?new u(!0,e.opacity):null===e?new u(null,1):new u(!1,e.opacity)}))}));r.filter((function(e){return e.filter((function(e){return!1===e.content})).length})).length&&((n=r).forEach((function(e,t){return e.forEach((function(e,r){!1!==n[t][r].content&&(function e(t,n){var r=n.x,a=n.y;if(!0===t[a][r].content||function(e,t,n){return t<0||e<0||t>=n.length||e>=n[0].length}(r,a,t))return!0;var c=new f(r,a-1),i=new f(r+1,a),o=new f(r,a+1),l=new f(r-1,a),u=[c,i,o,l];return u.filter((function(e){var n;return!1===(null===(n=e.currentContent(t))||void 0===n?void 0:n.content)})).length>0?(u.forEach((function(e){void 0!==e.currentContent(t)&&!0!==e.currentContent(t).content&&(t[e.y][e.x].content=!1)})),void 0!==t[a][r]&&!0!==t[a][r].content&&(t[a][r].content=!1),t.forEach((function(e,n){return e.forEach((function(e,r){"?"===e.content&&(t[n][r].content=!1)}))})),!1):(t[a][r].content="?",u.filter((function(n){return void 0===n.currentContent(t)||!0===n.currentContent(t).content||"?"===n.currentContent(t).content||null===n.currentContent(t).content&&e(t,{x:n.x,y:n.y})})).length>=4)}(n,{y:t,x:r}),n.forEach((function(e,t){return e.forEach((function(e,r){"?"===e.content&&(n[t][r].content=!0,n[t][r].opacity=.5)}))})))}))})),n).forEach((function(n,r){return n.forEach((function(n,a){!0===n.content&&(e[r][a]={color:t,opacity:n.opacity})}))}))}function y(e){return function(t){t({type:"SET_TEMP_FIELD_MATRIX",tempFieldMatrix:e})}}function p(e){return function(t){t({type:"SET_PLAYER",dice:null,currentFigure:null,currentPlayer:e})}}var E=n(271),g=n(270),h=n(269),b=n(275),O=n(273),x=n(35),j=n(274),S=n(279);n(129);var _=function(){var e=Object(o.b)();return a.a.createElement(E.a,{initialValues:{x:20,y:20,players:["Player 1","Player 2"]},onFinish:function(t){var n,r=t.x,a=t.y,c=t.players;return e((n={x:r,y:a,players:c},function(e){var t=n.players.map((function(e,t){return{name:e,color:["Red","Green","Yellow","Blue"][t],count:0}})),r=t[m(t.length)-1];e({type:"SET_CONFIG",config:n,fieldMatrix:d(n.x,n.y),tempFieldMatrix:d(n.x,n.y),players:t,currentPlayer:r})}))},className:"configurator"},a.a.createElement(g.a,{title:"Configurator"},a.a.createElement(h.a,{direction:"vertical"},a.a.createElement(E.a.Item,Object.assign({},I,{label:"Cells horizontaly",name:"y",rules:[{required:!0,message:"Please, input Y cells"}]}),a.a.createElement(b.a,{min:20,max:45})),a.a.createElement(E.a.Item,Object.assign({},I,{label:"Cells verticaly",name:"x",rules:[{required:!0,message:"Please, input X cells"}]}),a.a.createElement(b.a,{min:20,max:45})),a.a.createElement(E.a.List,{name:"players"},(function(e,t){var n=t.add,r=t.remove;return a.a.createElement("div",{style:{minHeight:224,minWidth:270}},e.map((function(t,n){return a.a.createElement(E.a.Item,{label:"Player ".concat(n+1),required:!0,key:t.key},a.a.createElement(E.a.Item,Object.assign({},t,{rules:[{required:!0,message:"Please input player's name."}],noStyle:!0}),a.a.createElement(O.a,{placeholder:"player name",style:{width:"90%"}})),e.length>2?a.a.createElement(j.a,{style:{marginLeft:5},title:"Remove player",onClick:function(){return r(t.name)}}):null)})),e.length<4?a.a.createElement(E.a.Item,null,a.a.createElement(x.a,{title:"Add player",type:"dashed",onClick:function(){return n()}},a.a.createElement(S.a,null)," Add player")):null)})),a.a.createElement(E.a.Item,null,a.a.createElement(x.a,{type:"primary",block:!0,htmlType:"submit",title:"Start game"},"Start")))))},I={labelCol:{span:12},wrapperCol:{span:12}};n(261);var w=function(){return a.a.createElement("div",{className:"header"},"GAME RANDOMFILL")},F=n(41),C=n(272),k=n(281),M=n(276),T=n(280),R=n(277),L=n(278),N=(n(262),function(e){var t,n=e.player,r=null===(t=Object(o.c)((function(e){return e.game.tempFieldMatrix})))||void 0===t?void 0:t.flat().filter((function(e){return.5===(null===e||void 0===e?void 0:e.opacity)})).length;if(!n)return null;var c=n.name,i=n.count,l=n.color;return a.a.createElement("div",null,a.a.createElement("div",null,c),a.a.createElement("div",{style:{color:l,fontSize:12}},"score: ",i," ",r?"+ ".concat(r," = ").concat(i+r):""))});var P=function(){var e=Object(r.useRef)(null),t=Object(o.c)((function(e){return e.game.dice})),n=Object(o.c)((function(e){return e.game.currentFigure})),c=Object(o.c)((function(e){return e.game.currentPlayer})),i=Object(o.c)((function(e){return e.game.players})),l=Object(o.c)((function(e){return e.game.tempFieldMatrix})),u=Object(o.c)((function(e){return e.game.fieldMatrix})),f=Object(r.useState)(!1),s=Object(F.a)(f,2),v=s[0],E=s[1],b=Object(r.useState)(!1),O=Object(F.a)(b,2),j=O[0],S=O[1],_=Object(o.b)(),I=Object(r.useCallback)((function(t){var n,r;e.current&&(e.current.style.left=t.pageX-e.current.offsetWidth/2+"px",e.current.style.top=t.pageY-e.current.offsetHeight/2+"px",_((n=t.x,r=t.y,function(e){e({type:"SET_FIGURE_POSITION",currentFigureX:n,currentFigureY:r})})))}),[_]);return a.a.createElement(g.a,{style:{position:"static"},title:a.a.createElement(N,{player:c}),actions:[a.a.createElement(x.a,{type:"link",title:"Undo",icon:a.a.createElement(k.a,{style:{fontSize:"28px",color:"#ff4d4f"}}),disabled:!v,onClick:function(){u&&(E(!1),_(y(u)))},key:"undo"}),a.a.createElement(x.a,{type:"link",title:"Submit move",icon:a.a.createElement(M.a,{style:{fontSize:"28px",color:"green"}}),disabled:!v,onClick:function(){if(i&&c&&l){var e,t=(null===l||void 0===l?void 0:l.join())!==(null===u||void 0===u?void 0:u.join());l&&t&&_((e=l.map((function(e){return e.map((function(e){return e&&(e.opacity=1),e}))})),function(t){t({type:"SET_FIELD_MATRIX",fieldMatrix:e})}));var n=i.findIndex((function(e){return e.name===c.name})),r=i[n+1]||i[0];E(!1),S(!1),c.count=l.flat().filter((function(e){return(null===e||void 0===e?void 0:e.color)===c.color})).length,_(p(Object.assign({},c))),_(p(r))}},key:"submit"})]},a.a.createElement(h.a,{style:{display:"flex",justifyContent:"center"}},a.a.createElement(x.a,{type:"primary",size:"large",title:"Roll dice/Get figure",disabled:j,onClick:function(){var e;(null===c||void 0===c?void 0:c.color)&&(S(!0),_((e=null===c||void 0===c?void 0:c.color,function(t){var n=m(),r=m();t({type:"ROLL_THE_DICE",dice:[n,r],currentFigure:d(n,r,e)})})))},icon:a.a.createElement(T.a,null)}),a.a.createElement(x.a,{title:"Rotate figure",type:"primary",size:"large",disabled:!t,onClick:function(){(null===c||void 0===c?void 0:c.color)&&_(function(e,t){return function(n){var r=e[1],a=e[0];n({type:"ROTATE_FIGURE",dice:[r,a],currentFigure:d(r,a,t)})}}(t||[1,1],null===c||void 0===c?void 0:c.color))},icon:a.a.createElement(R.a,null)}),a.a.createElement(C.a,{title:"Are you sure to skip move",onConfirm:function(){if(i&&c&&u){var e=i.findIndex((function(e){return e.name===c.name})),t=i[e+1]||i[0];E(!1),S(!1),_(p(t)),_(y(u))}}},a.a.createElement(x.a,{danger:!0,title:"Skipping",size:"large",icon:a.a.createElement(L.a,null)}))),a.a.createElement("div",{className:"new-figure-wrapper"},a.a.createElement("div",{className:"new-figure",ref:e,onMouseDown:function(t){e.current&&!v&&(e.current.style.position="absolute",e.current.style.top=t.pageY-e.current.offsetHeight/2+"px",e.current.style.left=t.pageX-e.current.offsetWidth/2+"px",document.addEventListener("mousemove",I))},onMouseUp:function(t){if(document.removeEventListener("mousemove",I),e.current){e.current.style.position="static",e.current.style.top="auto",e.current.style.left="auto";var n=(null===l||void 0===l?void 0:l.join())!==(null===u||void 0===u?void 0:u.join());l&&n&&E(!0)}}},n&&n.map((function(e,t){return a.a.createElement("div",{key:t,className:"new-figure__row"},e.map((function(e,t){return a.a.createElement("span",{key:t,style:{backgroundColor:v?"grey":(null===e||void 0===e?void 0:e.color)||"",zIndex:100},className:"new-figure__cell"})})))})))))};n(263);var A=function(){var e=Object(r.useRef)(null),t=Object(o.b)(),n=Object(o.c)((function(e){return e.game.fieldMatrix})),c=Object(o.c)((function(e){return e.game.tempFieldMatrix})),i=Object(o.c)((function(e){return e.game.cellSide})),l=Object(o.c)((function(e){return e.game.config})),u=Object(o.c)((function(e){return e.game.currentPlayer})),f=Object(o.c)((function(e){return e.game.dice})),d=Object(o.c)((function(e){return e.game.currentFigureX})),m=Object(o.c)((function(e){return e.game.currentFigureY})),p=Object(r.useState)(null),E=Object(F.a)(p,2),g=E[0],h=E[1];return Object(r.useEffect)((function(){var t=function(){e.current&&h(e.current.getBoundingClientRect())};return window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}}),[]),Object(r.useEffect)((function(){e.current&&h(e.current.getBoundingClientRect())}),[e]),Object(r.useEffect)((function(){if(e.current&&g&&l&&c&&n&&f&&u)if(function(e,t,n){var r=e.left<t&&e.right>t,a=e.top<n&&e.bottom>n;return!(!r||!a)}(g,d,m)){var r=function(e,t,n){return{xStart:Math.round(e-n[1]/2),xEnd:Math.round(e+n[1]/2),yStart:Math.round(t-n[0]/2),yEnd:Math.round(t+n[0]/2)}}((d-g.left)/i,(m-g.top)/i,f),a=0===(null===u||void 0===u?void 0:u.count);if(function(e,t){var n=t.x,r=t.y;return e.xStart<0||e.xEnd>n||e.yStart<0||e.yEnd>r}(r,l))t(y(n));else if(a&&!function(e,t){var n=t.x,r=t.y;return e.xStart<=0&&e.yStart<=0||e.xEnd===n&&e.yStart<=0||0===e.xStart&&e.yEnd===r||e.xEnd===n&&e.yEnd===r}(r,l))t(y(n));else if(function(e,t,n,r){if(r)return!0;var a=e.reduce((function(e,n,r,a){return t.yStart-1!==r&&r!==t.yEnd||e.push.apply(e,Object(s.a)(n.filter((function(e,n){return t.xStart<=n&&n<t.xEnd})))),t.yStart<=r&&r<t.yEnd&&e.push.apply(e,Object(s.a)(n.filter((function(e,n){return t.xStart-1===n||n===t.xEnd})))),e}),[]);return!(e.reduce((function(e,n,r,a){return t.yStart<=r&&r<t.yEnd&&e.push.apply(e,Object(s.a)(n.filter((function(e,n){return t.xStart<=n&&n<t.xEnd})))),e}),[]).filter((function(e){return e})).length>0)&&a.filter((function(e){return(null===e||void 0===e?void 0:e.color)===n.color})).length>0}(n,r,u,a)){var o=function(e,t,n,r){var a=e.map((function(e,r){return t.yStart<=r&&r<t.yEnd?e.map((function(e,r){return t.xStart<=r&&r<t.xEnd?{color:n,opacity:.5}:e?Object.assign({},e):null})):e.slice()}));return r||v(a,n),a}(n,r,u.color,a);t(y(o))}else t(y(n))}else t(y(n))}),[d,m,i,l,t]),a.a.createElement("div",{ref:e,className:"game-field"},c&&c.map((function(e,t){return a.a.createElement("div",{key:t,className:"game-field__row"},e.map((function(e,t){return a.a.createElement("span",{key:t,style:{backgroundColor:(null===e||void 0===e?void 0:e.color)||"",opacity:null===e||void 0===e?void 0:e.opacity},className:"game-field__cell"})})))})))};n(264);var z=function(){return a.a.createElement("div",{className:"game"},a.a.createElement(P,null),a.a.createElement(A,null))};n(265);var G=function(){return a.a.createElement("div",{className:"footer"},"developer ",a.a.createElement("a",{href:"https://github.com/shersh1k"},"shersh1k"))};n(266);var X=function(){var e=Object(o.c)((function(e){return e.game.config}));return a.a.createElement("div",{className:"app"},a.a.createElement(w,null),e?a.a.createElement(z,null):a.a.createElement(_,null),a.a.createElement(G,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Y=n(33),D=n(112),U=(n(267),n(11)),B={config:null,cellSide:20,fieldMatrix:null,tempFieldMatrix:null,dice:null,currentFigure:null,players:null,currentPlayer:null,currentFigureX:0,currentFigureY:0};var H=[D.a];var W=Object(Y.d)(Object(Y.c)({game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ROLL_THE_DICE":case"ROTATE_FIGURE":case"SET_CONFIG":case"SET_FIGURE_POSITION":case"SET_FIELD_MATRIX":case"SET_TEMP_FIELD_MATRIX":case"SET_FINAL_FIGURE_POSITION":case"SET_PLAYER":return Object(U.a)(Object(U.a)({},e),t);default:return e}}}),Y.a.apply(void 0,H));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(o.a,{store:W},a.a.createElement(X,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[118,1,2]]]);
//# sourceMappingURL=main.406bac77.chunk.js.map